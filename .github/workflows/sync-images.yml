name: Sync Public Images to Huawei SWR

on:
  workflow_dispatch:
  schedule:
    - cron: '0 2 * * *'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Docker
        run: |
          # 安装 Docker（如果需要）
          sudo apt update
          sudo apt install -y docker.io
          sudo systemctl start docker

      - name: Login to Huawei Cloud SWR
        run: |
          echo "${{ secrets.HW_SK }}" | docker login \
            -u "${{ secrets.HW_AK }}" \
            --password-stdin \
            swr.cn-east-3.myhuaweicloud.com

      - name: Pull, Tag and Push OpenJDK
        run: |
          # 拉取公共镜像
          docker pull eclipse-temurin:17-jre-alpine

          # 打标签
          docker tag eclipse-temurin:17-jre-alpine \
            swr.cn-east-3.myhuaweicloud.com/wzy/temurin:17-jre-alpine

          # 推送到 SWR
          docker push swr.cn-east-3.myhuaweicloud.com/wzy/temurin:17-jre-alpine

      # 可继续添加其他镜像...
